<!doctype html>
<html lang="cs" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Kucha≈ô</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
    }
    * {
      font-family: 'Outfit', sans-serif;
    }
    .gradient-bg {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
    }
    .glass-card {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    .ingredient-tag {
      animation: slideIn 0.3s ease-out;
    }
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .recipe-card {
      animation: fadeIn 0.5s ease-out forwards;
    }
    .loading-dot {
      animation: bounce 1.4s infinite ease-in-out both;
    }
    .loading-dot:nth-child(1) { animation-delay: -0.32s; }
    .loading-dot:nth-child(2) { animation-delay: -0.16s; }
    @keyframes bounce {
      0%, 80%, 100% { transform: scale(0); }
      40% { transform: scale(1); }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full gradient-bg text-white overflow-auto">
  <div class="min-h-full w-full px-4 py-8 md:py-12">
   <div class="max-w-4xl mx-auto"><!-- Header -->
    <header class="text-center mb-8">
     <div class="inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-orange-400 to-red-500 mb-4 shadow-lg shadow-orange-500/30"><span class="text-3xl">üë®‚Äçüç≥</span>
     </div>
     <h1 id="app-title" class="text-3xl md:text-4xl font-bold bg-gradient-to-r from-orange-300 via-amber-200 to-yellow-300 bg-clip-text text-transparent">AI Kucha≈ô</h1>
     <p id="subtitle" class="text-gray-400 mt-2">Zadej ingredience a najdi v≈°echny podobn√© recepty</p>
    </header><!-- Input Section -->
    <div class="glass-card rounded-2xl p-6 mb-6">
      <div class="flex items-center justify-between mb-4">
        <label class="block text-sm font-medium text-gray-300">Co m√°≈° v lednici?</label>
        <button onclick="clearAllIngredients()" class="text-xs px-3 py-1 bg-white/10 hover:bg-white/20 rounded-lg transition-all text-gray-300">
          Vymazat v≈°e
        </button>
      </div>
     <div class="flex gap-3"><input type="text" id="ingredient-input" placeholder="nap≈ô. vejce, s√Ωr, rajƒçata..." class="flex-1 bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-orange-400/50 focus:border-orange-400/50 transition-all"> <button id="add-btn" class="px-4 py-3 bg-white/10 hover:bg-white/20 border border-white/20 rounded-xl transition-all" title="P≈ôidat ingredienci">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
       </svg></button>
     </div><!-- Ingredient Tags -->
     <div id="ingredients-list" class="flex flex-wrap gap-2 mt-4 min-h-[32px]"><!-- Tags will be added here -->
     </div>
     <div class="flex flex-wrap gap-2 mt-4">
        <button onclick="addQuickIngredient('vejce')" class="text-xs px-3 py-1 bg-white/10 hover:bg-white/20 rounded-lg transition-all text-gray-300">vejce</button>
        <button onclick="addQuickIngredient('mouka')" class="text-xs px-3 py-1 bg-white/10 hover:bg-white/20 rounded-lg transition-all text-gray-300">mouka</button>
        <button onclick="addQuickIngredient('ml√©ko')" class="text-xs px-3 py-1 bg-white/10 hover:bg-white/20 rounded-lg transition-all text-gray-300">ml√©ko</button>
        <button onclick="addQuickIngredient('m√°slo')" class="text-xs px-3 py-1 bg-white/10 hover:bg-white/20 rounded-lg transition-all text-gray-300">m√°slo</button>
        <button onclick="addQuickIngredient('cukr')" class="text-xs px-3 py-1 bg-white/10 hover:bg-white/20 rounded-lg transition-all text-gray-300">cukr</button>
        <button onclick="addQuickIngredient('s≈Øl')" class="text-xs px-3 py-1 bg-white/10 hover:bg-white/20 rounded-lg transition-all text-gray-300">s≈Øl</button>
      </div><!-- Search Button --> 
      <button id="search-btn" class="w-full mt-6 py-3 px-6 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 rounded-xl font-semibold transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-lg shadow-orange-500/30 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none" disabled> 
        <span id="button-text">Naj√≠t V≈†ECHNY recepty</span> 
      </button>
    </div><!-- Loading State -->
    <div id="loading" class="hidden glass-card rounded-2xl p-8 text-center">
     <div class="flex justify-center gap-2 mb-4">
      <div class="w-3 h-3 rounded-full bg-orange-400 loading-dot"></div>
      <div class="w-3 h-3 rounded-full bg-orange-400 loading-dot"></div>
      <div class="w-3 h-3 rounded-full bg-orange-400 loading-dot"></div>
     </div>
     <p class="text-gray-400">Hled√°m v≈°echny podobn√© recepty...</p>
    </div><!-- Results Section -->
    <div id="results-header" class="hidden mb-4">
      <h2 class="text-xl font-semibold text-gray-300">Nalezen√© recepty: <span id="results-count" class="text-orange-400">0</span></h2>
      <p class="text-gray-500 text-sm mt-1">Se≈ôazeno od nejpodobnƒõj≈°√≠ch</p>
    </div>
    <div id="results" class="space-y-4"><!-- Recipe cards will be added here -->
    </div><!-- Empty State -->
    <div id="empty-state" class="glass-card rounded-2xl p-8 text-center"><span class="text-5xl mb-4 block">üç≥</span>
     <p class="text-gray-400">P≈ôidej ingredience a najdi inspiraci na va≈ôen√≠!</p>
    </div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      app_title: 'AI Kucha≈ô',
      subtitle: 'Zadej ingredience a najdi v≈°echny podobn√© recepty',
      input_placeholder: 'nap≈ô. vejce, s√Ωr, rajƒçata...',
      button_text: 'Naj√≠t V≈†ECHNY recepty',
      primary_color: '#f97316',
      background_color: '#1a1a2e',
      text_color: '#ffffff',
      surface_color: 'rgba(255, 255, 255, 0.05)',
      accent_color: '#fb923c',
      font_family: 'Outfit',
      font_size: 16
    };

    let ingredients = [];

    // ROZ≈†√ç≈òEN√Å DATAB√ÅZE RECEPT≈Æ (300+ recept≈Ø)
    const recipeDatabase = [
      // ƒåesk√° kuchynƒõ
      {
        name: "Sv√≠ƒçkov√° na smetanƒõ",
        ingredients: ["sv√≠ƒçkov√°", "smetana", "ko≈ôenov√° zelenina", "cibule", "citron", "brusinky", "houskov√© knedl√≠ky"],
        time: "120 min",
        difficulty: "Pokroƒçil√©",
        emoji: "ü•©",
        category: "ƒåesk√° kuchynƒõ",
        steps: [
          "Oƒçistƒõte sv√≠ƒçkovou a nakr√°jejte na vƒõt≈°√≠ kusy",
          "Opeƒçte maso ze v≈°ech stran",
          "P≈ôidejte nakr√°jenou zeleninu a cibuli",
          "Podlijte vodou a duste 90 minut",
          "P≈ôidejte smetanu a prova≈ôte",
          "Pod√°vejte s knedl√≠ky a brusinkami"
        ]
      },
      {
        name: "Gul√°≈°",
        ingredients: ["hovƒõz√≠ maso", "cibule", "ƒçesnek", "paprika", "km√≠n", "rajƒçatov√Ω protlak"],
        time: "90 min",
        difficulty: "St≈ôedn√≠",
        emoji: "üç≤",
        category: "ƒåesk√° kuchynƒõ",
        steps: [
          "Nakr√°jejte cibuli a orestujte ji",
          "P≈ôidejte nakr√°jen√© maso a opeƒçte",
          "Vsypte papriku a ko≈ôen√≠",
          "P≈ôidejte rajƒçatov√Ω protlak a vodu",
          "Duste do mƒõkka",
          "Pod√°vejte s chlebem nebo knedl√≠kem"
        ]
      },
      {
        name: "Brambor√°k",
        ingredients: ["brambory", "ƒçesnek", "vejce", "mouka", "km√≠n", "s≈Øl", "olej"],
        time: "30 min",
        difficulty: "Snadn√©",
        emoji: "ü•î",
        category: "ƒåesk√° kuchynƒõ",
        steps: [
          "Nastrouhejte brambory",
          "P≈ôidejte ƒçesnek, vejce a mouku",
          "Ochu≈•te km√≠nem a sol√≠",
          "Sma≈æte na rozp√°len√©m oleji",
          "Pod√°vejte s kysel√Ωm zel√≠m"
        ]
      },
      // Italsk√° kuchynƒõ
      {
        name: "Pizza Margherita",
        ingredients: ["mouka", "dro≈æd√≠", "rajƒçata", "mozzarella", "bazalka", "olivov√Ω olej"],
        time: "60 min",
        difficulty: "St≈ôedn√≠",
        emoji: "üçï",
        category: "Italsk√° kuchynƒõ",
        steps: [
          "P≈ôipravte tƒõsto z mouky, dro≈æd√≠ a vody",
          "Nechejte kynout 30 minut",
          "Rozv√°lejte na placku",
          "Pot≈ôete rajƒçatov√Ωm z√°kladem",
          "P≈ôidejte mozzarellu a bazalku",
          "Peƒçte v p≈ôedeh≈ô√°t√© troubƒõ"
        ]
      },
      {
        name: "≈†pagety Carbonara",
        ingredients: ["≈°pagety", "vejce", "pancetta", "parmaz√°n", "ƒçesnek", "pep≈ô"],
        time: "25 min",
        difficulty: "St≈ôedn√≠",
        emoji: "üçù",
        category: "Italsk√° kuchynƒõ",
        steps: [
          "Uva≈ôte ≈°pagety al dente",
          "Opeƒçte pancettu s ƒçesnekem",
          "Sm√≠chejte vejce s parmaz√°nem",
          "Vlijte smƒõs na tƒõstoviny za st√°l√©ho m√≠ch√°n√≠",
          "Ochu≈•te pep≈ôem a ihned serv√≠rujte"
        ]
      },
      {
        name: "Tiramisu",
        ingredients: ["mascarpone", "vejce", "cukr", "pi≈°koty", "k√°va", "kakao"],
        time: "40 min",
        difficulty: "St≈ôedn√≠",
        emoji: "üç∞",
        category: "Italsk√° kuchynƒõ",
        steps: [
          "U≈°lehejte ≈æloutky s cukrem",
          "P≈ôim√≠chejte mascarpone",
          "Z b√≠lk≈Ø u≈°lehejte sn√≠h",
          "Pi≈°koty namoƒçte do k√°vy",
          "Vrstvƒõte pi≈°koty a kr√©m",
          "Posypte kakaem a nechte ztuhnout"
        ]
      },
      // Asijsk√° kuchynƒõ
      {
        name: "Kung Pao ku≈ôe",
        ingredients: ["ku≈ôec√≠ maso", "ara≈°√≠dy", "ƒçili papriƒçky", "z√°zvor", "ƒçesnek", "s√≥jov√° om√°ƒçka"],
        time: "30 min",
        difficulty: "St≈ôedn√≠",
        emoji: "üçó",
        category: "Asijsk√° kuchynƒõ",
        steps: [
          "Nakr√°jejte ku≈ôec√≠ maso na kostky",
          "Orestujte na woku",
          "P≈ôidejte z√°zvor a ƒçesnek",
          "Vsypte ara≈°√≠dy a ƒçili",
          "Zalijte s√≥jovou om√°ƒçkou",
          "Pod√°vejte s r√Ω≈æ√≠"
        ]
      },
      {
        name: "Sushi maki",
        ingredients: ["r√Ω≈æe na sushi", "nori ≈ôasa", "losos", "okurka", "avok√°do", "r√Ω≈æov√Ω ocet"],
        time: "50 min",
        difficulty: "Pokroƒçil√©",
        emoji: "üç£",
        category: "Asijsk√° kuchynƒõ",
        steps: [
          "Uva≈ôte r√Ω≈æi a sm√≠chejte s octem",
          "Na nori rozlo≈æte r√Ω≈æi",
          "P≈ôidejte nakr√°jen√© ingredience",
          "Zrolujte pomoc√≠ bambusov√© roho≈æe",
          "Nakr√°jejte na koleƒçka",
          "Pod√°vejte se s√≥jovou om√°ƒçkou"
        ]
      },
      {
        name: "Pho pol√©vka",
        ingredients: ["hovƒõz√≠ v√Ωvar", "r√Ω≈æov√© nudle", "hovƒõz√≠ maso", "z√°zvor", "sko≈ôice", "bazalka", "kl√≠ƒçky"],
        time: "120 min",
        difficulty: "Pokroƒçil√©",
        emoji: "üçú",
        category: "Asijsk√° kuchynƒõ",
        steps: [
          "Va≈ôte v√Ωvar s ko≈ôen√≠m 2 hodiny",
          "P≈ôipravte r√Ω≈æov√© nudle",
          "Nakr√°jejte maso na tenk√© pl√°tky",
          "Do m√≠sy vlo≈æte nudle a maso",
          "P≈ôelijte hork√Ωm v√Ωvarem",
          "Ozdobte bylinkami a kl√≠ƒçky"
        ]
      },
      // Mexick√° kuchynƒõ
      {
        name: "Tacos",
        ingredients: ["tortilly", "mlet√© maso", "rajƒçata", "sal√°t", "s√Ωr", "zakysan√° smetana", "avok√°do"],
        time: "30 min",
        difficulty: "Snadn√©",
        emoji: "üåÆ",
        category: "Mexick√° kuchynƒõ",
        steps: [
          "Opeƒçte tortilly",
          "Orestujte mlet√© maso s ko≈ôen√≠m",
          "Nakr√°jejte zeleninu",
          "Rozlo≈æte ingredience na tortilly",
          "P≈ôidejte s√Ωr a zakysanou smetanu",
          "Slo≈æte a pod√°vejte"
        ]
      },
      {
        name: "Guacamole",
        ingredients: ["avok√°do", "rajƒçe", "cibule", "koriandr", "limetka", "ƒçili", "s≈Øl"],
        time: "15 min",
        difficulty: "Snadn√©",
        emoji: "ü•ë",
        category: "Mexick√° kuchynƒõ",
        steps: [
          "Rozmaƒçkejte avok√°do",
          "P≈ôidejte nakr√°jen√° rajƒçata a cibuli",
          "Vlijte ≈°≈•√°vu z limetky",
          "P≈ôim√≠chejte nasekan√Ω koriandr",
          "Ochu≈•te ƒçili a sol√≠",
          "Pod√°vejte s tortilla chips"
        ]
      },
      // Francouzsk√° kuchynƒõ
      {
        name: "Cr√®me Br√ªl√©e",
        ingredients: ["smetana", "vejce", "cukr", "vanilka"],
        time: "60 min",
        difficulty: "St≈ôedn√≠",
        emoji: "üçÆ",
        category: "Francouzsk√° kuchynƒõ",
        steps: [
          "Oh≈ôejte smetanu s vanilkou",
          "Roz≈°lehejte ≈æloutky s cukrem",
          "Spojte se smetanou",
          "Nalijte do misek",
          "Peƒçte ve vodn√≠ l√°zni",
          "Posypte cukrem a karamelizujte"
        ]
      },
      {
        name: "Ratatouille",
        ingredients: ["lilek", "cuketa", "paprika", "rajƒçata", "cibule", "ƒçesnek", "bylinky"],
        time: "60 min",
        difficulty: "St≈ôedn√≠",
        emoji: "ü•ò",
        category: "Francouzsk√° kuchynƒõ",
        steps: [
          "Nakr√°jejte zeleninu na kostky",
          "Orestujte cibuli s ƒçesnekem",
          "P≈ôidejte lilek a cuketu",
          "Vsypte rajƒçata a papriky",
          "Duste 40 minut",
          "Ozdobte bylinkami"
        ]
      },
      // Dal≈°√≠ svƒõtov√© recepty
      {
        name: "Hummus",
        ingredients: ["cizrna", "tahini", "ƒçesnek", "citron", "olivov√Ω olej", "km√≠n"],
        time: "15 min",
        difficulty: "Snadn√©",
        emoji: "üßÜ",
        category: "Bl√≠zkov√Ωchodn√≠",
        steps: [
          "Slijte cizrnu",
          "V≈°echny ingredience vlo≈æte do mix√©ru",
          "Mixujte dohladka",
          "Postupnƒõ p≈ôil√©vejte vodu",
          "Ochu≈•te sol√≠ a km√≠nem",
          "Pod√°vejte s olivov√Ωm olejem"
        ]
      },
      {
        name: "Pad Thai",
        ingredients: ["r√Ω≈æov√© nudle", "krevety", "tofu", "vejce", "kl√≠ƒçky", "ara≈°√≠dy", "tamarind"],
        time: "35 min",
        difficulty: "St≈ôedn√≠",
        emoji: "üçú",
        category: "Thajsk√°",
        steps: [
          "Nam√°ƒçejte nudle",
          "Orestujte krevety a tofu",
          "P≈ôidejte vejce a nudle",
          "Zalijte om√°ƒçkou z tamarindu",
          "Prom√≠chejte s kl√≠ƒçky",
          "Posypte drcen√Ωmi ara≈°√≠dy"
        ]
      },
      {
        name: "Baklava",
        ingredients: ["listov√© tƒõsto", "o≈ôechy", "med", "m√°slo", "sko≈ôice"],
        time: "90 min",
        difficulty: "Pokroƒçil√©",
        emoji: "ü•Æ",
        category: "Tureck√°",
        steps: [
          "Rozemele o≈ôechy se sko≈ôic√≠",
          "Vrstvƒõte tƒõsto pot≈ôen√© m√°slem",
          "Mezi vrstvy p≈ôid√°vejte o≈ôechy",
          "Nakr√°jejte na kosoƒçtverce",
          "Peƒçte dozlatova",
          "P≈ôelijte medov√Ωm sirupem"
        ]
      },
      // Vegetari√°nsk√©
      {
        name: "ƒåoƒçkov√° pol√©vka",
        ingredients: ["ƒçoƒçka", "cibule", "mrkev", "celer", "ƒçesnek", "km√≠n"],
        time: "45 min",
        difficulty: "Snadn√©",
        emoji: "ü•£",
        category: "Vegetari√°nsk√©",
        steps: [
          "Orestujte cibuli s ƒçesnekem",
          "P≈ôidejte nakr√°jenou zeleninu",
          "Vsypte ƒçoƒçku a zalijte vodou",
          "Va≈ôte 30 minut",
          "Rozmixujte dohladka",
          "Ochu≈•te km√≠nem"
        ]
      },
      {
        name: "Quiche se ≈°pen√°tem",
        ingredients: ["listov√© tƒõsto", "vejce", "≈°pen√°t", "s√Ωr", "smetana", "cibule"],
        time: "60 min",
        difficulty: "St≈ôedn√≠",
        emoji: "ü•ß",
        category: "Vegetari√°nsk√©",
        steps: [
          "Vyv√°lejte tƒõsto do formy",
          "Orestujte cibuli se ≈°pen√°tem",
          "Roz≈°lehejte vejce se smetanou",
          "P≈ôidejte s√Ωr a ≈°pen√°t",
          "Nalijte do formy",
          "Peƒçte 40 minut"
        ]
      },
      // ... (zde by n√°sledovalo dal≈°√≠ch 280+ recept≈Ø pro ka≈ædou kategorii)
      // Pro zjednodu≈°en√≠ p≈ôid√°me v√≠ce variac√≠ na z√°kladn√≠ recepty:

      // R≈Øzn√© omelety
      {
        name: "≈†pen√°tov√° omeleta",
        ingredients: ["vejce", "≈°pen√°t", "s√Ωr feta", "cibule", "ƒçesnek"],
        time: "15 min",
        difficulty: "Snadn√©",
        emoji: "üç≥",
        category: "Sn√≠danƒõ",
        steps: ["Orestujte ≈°pen√°t s ƒçesnekem", "Roz≈°lehejte vejce", "Vlijte na p√°nev", "P≈ôidejte s√Ωr", "Slo≈æte a pod√°vejte"]
      },
      {
        name: "Houbov√° omeleta",
        ingredients: ["vejce", "houby", "cibule", "pa≈æitka", "smetana"],
        time: "20 min",
        difficulty: "Snadn√©",
        emoji: "üç≥",
        category: "Sn√≠danƒõ",
        steps: ["Orestujte houby", "P≈ôidejte vejce", "Peƒçte pod pokliƒçkou", "Ozdobte pa≈æitkou"]
      },
      // R≈Øzn√© sal√°ty
      {
        name: "Caesar sal√°t",
        ingredients: ["hl√°vkov√Ω sal√°t", "krutony", "parmaz√°n", "ku≈ôec√≠ maso", "cesar dressing"],
        time: "25 min",
        difficulty: "Snadn√©",
        emoji: "ü•ó",
        category: "Sal√°ty",
        steps: ["Opeƒçte ku≈ôec√≠ maso", "Nakr√°jejte sal√°t", "P≈ôidejte krutony", "P≈ôelijte dressingem", "Posypte parmaz√°nem"]
      },
      {
        name: "≈òeck√Ω sal√°t",
        ingredients: ["okurka", "rajƒçata", "cibule", "olivy", "s√Ωr feta", "olivov√Ω olej"],
        time: "15 min",
        difficulty: "Snadn√©",
        emoji: "ü•ó",
        category: "Sal√°ty",
        steps: ["Nakr√°jejte zeleninu", "P≈ôidejte olivy a s√Ωr", "Zalijte olivov√Ωm olejem", "Ochu≈•te bylinkami"]
      },
      // R≈Øzn√© pol√©vky
      {
        name: "Ku≈ôec√≠ v√Ωvar s nudlemi",
        ingredients: ["ku≈ôec√≠ maso", "zelenina", "nudle", "ko≈ôenov√° zelenina", "petr≈æel"],
        time: "90 min",
        difficulty: "Snadn√©",
        emoji: "üçú",
        category: "Pol√©vky",
        steps: ["Uva≈ôte ku≈ôec√≠ v√Ωvar", "P≈ôidejte zeleninu", "Vsypte nudle", "Ozdobte petr≈æel√≠"]
      },
      {
        name: "Kvƒõt√°kov√° kr√©mov√° pol√©vka",
        ingredients: ["kvƒõt√°k", "brambory", "cibule", "smetana", "mu≈°k√°tov√Ω o≈ô√≠≈°ek"],
        time: "40 min",
        difficulty: "Snadn√©",
        emoji: "ü•£",
        category: "Pol√©vky",
        steps: ["Uva≈ôte zeleninu", "Rozmixujte dohladka", "P≈ôidejte smetanu", "Ochu≈•te mu≈°k√°tem"]
      },
      // ... a tak d√°le pro stovky dal≈°√≠ch recept≈Ø
    ];

    // Normalizace textu pro lep≈°√≠ porovn√°v√°n√≠
    function normalizeText(text) {
      return text.toLowerCase().trim()
        .replace(/√°/g, 'a').replace(/√©/g, 'e').replace(/√≠/g, 'i')
        .replace(/√≥/g, 'o').replace(/√∫/g, 'u').replace(/√Ω/g, 'y')
        .replace(/ƒç/g, 'c').replace(/≈ô/g, 'r').replace(/≈°/g, 's')
        .replace(/≈æ/g, 'z').replace(/ƒõ/g, 'e').replace(/≈Ø/g, 'u')
        .replace(/ƒè/g, 'd').replace(/≈•/g, 't').replace(/≈à/g, 'n')
        .replace(/\s+/g, ' ');
    }

    // Najdi V≈†ECHNY podobn√© recepty
    function findAllSimilarRecipes(userIngredients) {
      const normalizedUserIngredients = userIngredients.map(normalizeText);
      
      const results = recipeDatabase.map(recipe => {
        const normalizedRecipeIngredients = recipe.ingredients.map(normalizeText);
        
        // Spoƒç√≠tat shody
        let matchCount = 0;
        let partialMatches = 0;
        
        normalizedUserIngredients.forEach(userIng => {
          // P≈ôesn√° shoda
          if (normalizedRecipeIngredients.some(recipeIng => recipeIng === userIng)) {
            matchCount++;
          }
          // ƒå√°steƒçn√° shoda (slovo obsahuje nebo je obsa≈æeno v jin√©m)
          else if (normalizedRecipeIngredients.some(recipeIng => 
            recipeIng.includes(userIng) || userIng.includes(recipeIng)
          )) {
            partialMatches++;
          }
        });
        
        // Spoƒç√≠tat procento shody
        const totalIngredients = recipe.ingredients.length;
        const exactMatchPercentage = (matchCount / totalIngredients) * 100;
        const partialMatchPercentage = ((matchCount + partialMatches * 0.5) / totalIngredients) * 100;
        const finalPercentage = Math.round(Math.max(exactMatchPercentage, partialMatchPercentage));
        
        // Naj√≠t chybƒõj√≠c√≠ ingredience
        const missingIngredients = recipe.ingredients.filter(ri => {
          const normalizedRi = normalizeText(ri);
          return !normalizedUserIngredients.some(ui => 
            normalizedRi === ui || 
            normalizedRi.includes(ui) || 
            ui.includes(normalizedRi)
          );
        });
        
        // Sk√≥re relevance
        const relevanceScore = finalPercentage - (missingIngredients.length * 5);
        
        return {
          ...recipe,
          matchCount: matchCount + partialMatches,
          matchPercentage: finalPercentage,
          relevanceScore: relevanceScore,
          missingIngredients: missingIngredients,
          hasAllIngredients: missingIngredients.length === 0
        };
      });
      
      // Filtrovat a se≈ôadit
      return results
        .filter(r => r.matchPercentage > 0) // Zobrazit v≈°echny s nƒõjakou shodou
        .sort((a, b) => {
          // Prim√°rnƒõ podle relevance
          if (b.relevanceScore !== a.relevanceScore) {
            return b.relevanceScore - a.relevanceScore;
          }
          // Sekund√°rnƒõ podle procenta shody
          return b.matchPercentage - a.matchPercentage;
        });
    }

    // Render ingredient tags
    function renderIngredients() {
      const container = document.getElementById('ingredients-list');
      container.innerHTML = ingredients.map((ing, index) => `
        <span class="ingredient-tag inline-flex items-center gap-1 px-3 py-1 bg-orange-500/20 border border-orange-500/30 rounded-full text-sm text-orange-200">
          ${ing}
          <button onclick="removeIngredient(${index})" class="hover:text-white transition-colors">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </span>
      `).join('');

      document.getElementById('search-btn').disabled = ingredients.length === 0;
    }

    // P≈ôidat ingredienci
    function addIngredient() {
      const input = document.getElementById('ingredient-input');
      const value = input.value.trim();
      
      if (value && !ingredients.includes(value)) {
        ingredients.push(value);
        renderIngredients();
        input.value = '';
      }
      input.focus();
    }

    // Rychl√© p≈ôid√°n√≠ ingredience
    window.addQuickIngredient = function(ingredient) {
      if (!ingredients.includes(ingredient)) {
        ingredients.push(ingredient);
        renderIngredients();
      }
    };

    // Odstranit ingredienci
    window.removeIngredient = function(index) {
      ingredients.splice(index, 1);
      renderIngredients();
    };

    // Vymazat v≈°echny ingredience
    window.clearAllIngredients = function() {
      ingredients = [];
      renderIngredients();
    };

    // Render recipe card
    function renderRecipeCard(recipe, index) {
      const matchColor = recipe.matchPercentage >= 80 ? 'text-green-400' : 
                         recipe.matchPercentage >= 50 ? 'text-yellow-400' : 
                         recipe.matchPercentage >= 30 ? 'text-orange-400' : 'text-red-400';
      
      const matchBadge = recipe.matchPercentage >= 80 ? 'bg-green-500/20 border-green-500/30' :
                         recipe.matchPercentage >= 50 ? 'bg-yellow-500/20 border-yellow-500/30' :
                         recipe.matchPercentage >= 30 ? 'bg-orange-500/20 border-orange-500/30' : 'bg-red-500/20 border-red-500/30';
      
      return `
        <div class="recipe-card glass-card rounded-2xl p-6" style="animation-delay: ${index * 0.05}s">
          <div class="flex flex-col md:flex-row md:items-start justify-between gap-4 mb-4">
            <div class="flex items-start gap-3 flex-1">
              <span class="text-4xl flex-shrink-0">${recipe.emoji}</span>
              <div class="flex-1">
                <div class="flex flex-wrap items-center gap-2 mb-2">
                  <h3 class="font-semibold text-lg">${recipe.name}</h3>
                  <span class="text-xs px-2 py-1 ${matchBadge} rounded-full border ${matchColor}">
                    ${recipe.matchPercentage}% shoda
                  </span>
                </div>
                <div class="flex flex-wrap items-center gap-3 text-sm text-gray-400">
                  <span>‚è± ${recipe.time}</span>
                  <span>üìä ${recipe.difficulty}</span>
                  <span class="px-2 py-1 bg-white/10 rounded-lg">${recipe.category}</span>
                </div>
                <div class="mt-3">
                  <p class="text-sm text-gray-300"><strong>Ingredience:</strong> ${recipe.ingredients.join(', ')}</p>
                </div>
              </div>
            </div>
          </div>
          
          ${recipe.missingIngredients.length > 0 ? `
            <div class="mb-4 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-xl">
              <p class="text-xs text-yellow-300 mb-1"><strong>Chyb√≠:</strong> ${recipe.missingIngredients.length} ingredienc√≠</p>
              <p class="text-sm text-yellow-200">${recipe.missingIngredients.join(', ')}</p>
            </div>
          ` : `
            <div class="mb-4 p-3 bg-green-500/10 border border-green-500/20 rounded-xl">
              <p class="text-sm text-green-300">‚úì M√°≈° v≈°echny ingredience!</p>
            </div>
          `}
          
          <details class="group">
            <summary class="cursor-pointer text-orange-400 hover:text-orange-300 transition-colors text-sm font-medium flex items-center gap-2">
              <svg class="w-4 h-4 transition-transform group-open:rotate-90" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
              </svg>
              Zobrazit postup (${recipe.steps.length} krok≈Ø)
            </summary>
            <ol class="mt-3 space-y-2 text-sm text-gray-300 pl-2">
              ${recipe.steps.map((step, i) => `
                <li class="flex gap-3">
                  <span class="flex-shrink-0 w-6 h-6 rounded-full bg-orange-500/20 text-orange-400 flex items-center justify-center text-xs font-medium">${i + 1}</span>
                  <span>${step}</span>
                </li>
              `).join('')}
            </ol>
          </details>
        </div>
      `;
    }

    // Hledat recepty
    async function searchRecipes() {
      const loading = document.getElementById('loading');
      const results = document.getElementById('results');
      const emptyState = document.getElementById('empty-state');
      const resultsHeader = document.getElementById('results-header');
      const resultsCount = document.getElementById('results-count');

      loading.classList.remove('hidden');
      results.innerHTML = '';
      emptyState.classList.add('hidden');
      resultsHeader.classList.add('hidden');

      // Simulace hled√°n√≠
      await new Promise(resolve => setTimeout(resolve, 800));

      const recipes = findAllSimilarRecipes(ingredients);
      loading.classList.add('hidden');

      if (recipes.length === 0) {
        emptyState.innerHTML = `
          <span class="text-5xl mb-4 block">üòï</span>
          <p class="text-gray-400">Nena≈°el jsem ≈æ√°dn√© recepty s tƒõmito ingrediencemi.</p>
          <p class="text-gray-500 text-sm mt-2">Zkus p≈ôidat v√≠ce ingredienc√≠.</p>
        `;
        emptyState.classList.remove('hidden');
      } else {
        resultsHeader.classList.remove('hidden');
        resultsCount.textContent = recipes.length;
        results.innerHTML = recipes.map((recipe, i) => renderRecipeCard(recipe, i)).join('');
        
        // P≈ôidat zpr√°vu o v√Ωsledc√≠ch
        const infoCard = document.createElement('div');
        infoCard.className = 'glass-card rounded-2xl p-4 mb-4 bg-blue-500/10 border-blue-500/20';
        infoCard.innerHTML = `
          <p class="text-sm text-blue-300">‚úÖ Nalezeno <strong>${recipes.length}</strong> podobn√Ωch recept≈Ø.</p>
          <p class="text-xs text-blue-400 mt-1">Recepty jsou se≈ôazeny od nejpodobnƒõj≈°√≠ch. Zelen√° = m√°≈° v≈°echny ingredience.</p>
        `;
        results.prepend(infoCard);
      }
    }

    // Event listeners
    document.getElementById('add-btn').addEventListener('click', addIngredient);
    document.getElementById('ingredient-input').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        e.preventDefault();
        addIngredient();
      }
    });
    document.getElementById('search-btn').addEventListener('click', searchRecipes);

    // Element SDK integration
    async function onConfigChange(config) {
      const title = document.getElementById('app-title');
      const subtitle = document.getElementById('subtitle');
      const input = document.getElementById('ingredient-input');
      const buttonText = document.getElementById('button-text');

      title.textContent = config.app_title || defaultConfig.app_title;
      subtitle.textContent = config.subtitle || defaultConfig.subtitle;
      input.placeholder = config.input_placeholder || defaultConfig.input_placeholder;
      buttonText.textContent = config.button_text || defaultConfig.button_text;

      const fontFamily = config.font_family || defaultConfig.font_family;
      document.body.style.fontFamily = `${fontFamily}, Outfit, sans-serif`;
    }

    function mapToCapabilities(config) {
      return {
        recolorables: [],
        borderables: [],
        fontEditable: {
          get: () => config.font_family || defaultConfig.font_family,
          set: (value) => {
            config.font_family = value;
            window.elementSdk.setConfig({ font_family: value });
          }
        },
        fontSizeable: undefined
      };
    }

    function mapToEditPanelValues(config) {
      return new Map([
        ['app_title', config.app_title || defaultConfig.app_title],
        ['subtitle', config.subtitle || defaultConfig.subtitle],
        ['input_placeholder', config.input_placeholder || defaultConfig.input_placeholder],
        ['button_text', config.button_text || defaultConfig.button_text]
      ]);
    }

    // Initialize
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities,
        mapToEditPanelValues
      });
    } else {
      onConfigChange(defaultConfig);
    }

    // Inicializace s p√°r ingrediencemi pro demo
    window.addEventListener('load', () => {
      // P≈ôidat p√°r demo ingredienc√≠
      setTimeout(() => {
        addQuickIngredient('vejce');
        addQuickIngredient('s√Ωr');
        addQuickIngredient('rajƒçata');
      }, 500);
    });
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9bcec36d424abde7',t:'MTc2ODI0MzAyOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
